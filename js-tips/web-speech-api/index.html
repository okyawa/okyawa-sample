<!DOCTYPE HTML>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>Web Speech APIã®éŸ³å£°èª­ã¿ä¸Šã’ã¨éŸ³å£°èªè­˜ã®Sample</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="author" content="okyawa">
  <meta name="robots" content="noindex">

  <link rel="stylesheet" href="/res/css/presentation.css?v=4" />

  <!-- â†“ã‚³ãƒ¼ãƒ‰ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ -->
  <link rel="stylesheet" href="/res/js/highlight-js/styles/atom-one-light.min.css">
  <script src="/res/js/highlight-js/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
  </script>
  <!-- â†‘ã‚³ãƒ¼ãƒ‰ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ -->

  <!-- â†“Markdownå½¢å¼ã®å¤‰æ› -->
  <script src="/res/js/marked-js/marked.min.js"></script>
  <script src="/res/js/marked-js/setup-marked.js?v=1"></script>
  <!-- â†‘Markdownå½¢å¼ã®å¤‰æ› -->

  <!-- â†“ç”»é¢å¹…375pxä»¥ä¸‹ã‚’Viewportã®è¡¨ç¤ºå€ç‡ç¸®å°ã«ã‚ˆã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ -->
  <script src="/res/js/viewport-responsive/viewport-responsive.js?v=1"></script>
  <!-- â†‘ç”»é¢å¹…375pxä»¥ä¸‹ã‚’Viewportã®è¡¨ç¤ºå€ç‡ç¸®å°ã«ã‚ˆã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ -->

  <script src="/res/js/presentation/presentation.js"></script>

  <!-- â†“ã“ã®HTMLå°‚ç”¨ã®æŒ‡å®š -->
  <!-- â†‘ã“ã®HTMLå°‚ç”¨ã®æŒ‡å®š -->

</head>
<body>
  <div id="container">

    <header>
      <h1>Web Speech API</h1>
      <h2>ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§éŸ³å£°èª­ã¿ä¸Šã’ã¨éŸ³å£°èªè­˜</h2>
    </header>

    <br />

    <section>
      <details open>
        <summary><h2>Web Speech APIã¨ã¯</h2></summary>

        <div class="markdown_content">
- éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã‚’Webã‚¢ãƒ—ãƒªã«çµ„ã¿å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹
- `SpeechSynthesis` (éŸ³å£°åˆæˆã€`Text-to-Speech`) ã¨ `SpeechRecognition` (éåŒæœŸéŸ³å£°èªè­˜ã€`Asynchronous Speech Recognition`) ã®2ã¤ã‹ã‚‰æˆã‚Šç«‹ã¤
        </div>

      </details>
    </section>

    <section>
      <details open>
        <summary><h2>éŸ³å£°èª­ã¿ä¸Šã’</h2></summary>

        <div class="markdown_content">
- éŸ³å£°åˆæˆã¯ã€ `SpeechSynthesis` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã€ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿ä¸Šã’ã‚‹æ©Ÿèƒ½ã‚’æä¾›
- éŸ³å£°ã®ç¨®é¡ã¯ `SpeechSynthesisVoice` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«å†…è”µã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‹ã‚‰æŒ‡å®šå¯èƒ½
        </div>

      </details>
    </section>

    <section>
      <details open>
        <summary><h2>éŸ³å£°èªè­˜</h2></summary>

        <div class="markdown_content">
- éŸ³å£°ã¯ã€ `SpeechRecognition` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã€éŸ³å£°èªè­˜ã‚’è¡Œã†æ©Ÿèƒ½ã‚’æä¾›
- ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ç«¯æœ«ã®ãƒã‚¤ã‚¯ã‚’é€šã—ã¦å…¥åŠ›ã•ã‚ŒãŸéŸ³å£°ã‚’æ¤œçŸ¥
- `SpeechGrammar` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã§ã€èªè­˜ã‚µãƒ¼ãƒ“ã‚¹ã«èªè­˜ã•ã›ãŸã„å˜èªã®ã‚»ãƒƒãƒˆã¾ãŸã¯å˜èªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã§ãã‚‹
- Chromeãªã©ä¸€éƒ¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§ã¯ã€Webãƒšãƒ¼ã‚¸ä¸Šã§éŸ³å£°èªè­˜ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ãƒ™ãƒ¼ã‚¹ã®èªè­˜ã‚¨ãƒ³ã‚¸ãƒ³ãŒä½¿ç”¨ã•ã‚Œã‚‹
  - éŸ³å£°ã‚’èªè­˜å‡¦ç†ã™ã‚‹ãŸã‚ã«Webã‚µãƒ¼ãƒ“ã‚¹ã¸é€ä¿¡ã™ã‚‹ãŸã‚ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã¯å‹•ä½œã—ãªã„
        </div>

      </details>
    </section>

    <section>
      <details open>
        <summary><h2>éŸ³å£°èª­ã¿ä¸Šã’ã®ãƒ‡ãƒ¢</h2></summary>

        <form>
          <fieldset>
            <legend>éŸ³å£°èª­ã¿ä¸Šã’</legend>
            <div style="margin-bottom: 8px;">
              <label for="voice_select">å£°ã®ç¨®é¡: </label>
              <select id="voice_select"></select>
            </div>
            <label for="speech_text">èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ: </label>
            <input type="text" id="speech_text" name="speech_text" value="ã“ã‚“ã«ã¡ã¯" />
            <button type="button" id="speech_button">èª­ã¿ä¸Šã’</button>
          </fieldset>
        </form>

        <script>
          /**
           * Web Speech APIã®SpeechSynthesisã‚’ä½¿ã£ãŸéŸ³å£°èª­ã¿ä¸Šã’ã®åˆæœŸåŒ–
           * 
           * @param {HTMLButtonElement} buttonElement èª­ã¿ä¸Šã’ã‚’é–‹å§‹ã™ã‚‹ãƒœã‚¿ãƒ³è¦ç´ 
           * @param {HTMLInputElement} inputElement èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹è¦ç´ 
           * @param {HTMLSelectElement} voiceSelectElement éŸ³å£°ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹è¦ç´ 
           */
          function setupSpeechSynthesis(buttonElement, inputElement, voiceSelectElement) {
            /** èª­ã¿ä¸Šã’è¨€èª */
            const LANG = 'ja-JP';

            /**
             * éŸ³å£°åˆæˆã®éŸ³å£°ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¦ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã«ã‚»ãƒƒãƒˆ
             */
            const populateVoiceList = () => {
              voiceSelectElement.innerHTML = '';
              // ãƒ–ãƒ©ã‚¦ã‚¶ã§åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã€ä½¿ç”¨ã™ã‚‹è¨€èªã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
              window.speechSynthesis.getVoices()
                .filter((voice) => voice.lang === LANG)
                .forEach((voice, index) => {
                  // å–å¾—ã—ãŸéŸ³å£°ãƒªã‚¹ãƒˆã‚’ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã®é¸æŠè‚¢ã«è¿½åŠ 
                  const option = document.createElement('option');
                  option.textContent = `${voice.name} (${voice.lang})`;
                  option.value = index;
                  voiceSelectElement.appendChild(option);
                });
            }
            populateVoiceList();
            speechSynthesis.onvoiceschanged = populateVoiceList;

            // ãƒœã‚¿ãƒ³ã«éŸ³å£°èª­ã¿ä¸Šã’ã®é–‹å§‹ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚»ãƒƒãƒˆ
            buttonElement.addEventListener('click', () => {
              // èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
              const speechText = inputElement.value;
              // SpeechSynthesisUtteranceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
              const speech = new SpeechSynthesisUtterance(speechText);
              // èª­ã¿ä¸Šã’è¨€èª (æ—¢å®šå€¤: HTMLã®langå±æ€§ã€ãªã‘ã‚Œã°UserAgentã®è¨€èª)
              speech.lang = LANG;
              // èª­ã¿ä¸Šã’é€Ÿåº¦ (0.1ã€œ10.0, æ—¢å®šå€¤: 1.0)
              speech.rate = 1.0;
              // èª­ã¿ä¸Šã’éŸ³é‡ (0.0ã€œ1.0, æ—¢å®šå€¤: 1.0)
              speech.volume = 1.0;
              // èª­ã¿ä¸Šã’éŸ³ç¨‹ (0.1ã€œ2.0, æ—¢å®šå€¤: 1.0)
              speech.pitch = 1.0;
              // èª­ã¿ä¸Šã’éŸ³å£° (SpeechSynthesisVoiceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)
              const selectedVoiceIndex = voiceSelectElement.value;
              const voices = speechSynthesis.getVoices()
                .filter((voice) => voice.lang === LANG);
              speech.voice = voices[selectedVoiceIndex];
              // èª­ã¿ä¸Šã’ã®é–‹å§‹
              speechSynthesis.speak(speech);
            });
          }

          const speechButtonElem = document.getElementById('speech_button');
          const speechTextElem = document.getElementById('speech_text');
          const voiceSelectElem = document.getElementById('voice_select');
          setupSpeechSynthesis(speechButtonElem, speechTextElem, voiceSelectElem);
        </script>

      </details>
    </section>

    <section>
      <details>
        <summary><h2>éŸ³å£°èª­ã¿ä¸Šã’ã®ã‚³ãƒ¼ãƒ‰</h2></summary>

        <details open>
          <summary><h3>HTML</h3></summary>

<pre><code class="language-html">&lt;div&gt;
  &lt;label for=&quot;voice_select&quot;&gt;å£°ã®ç¨®é¡: &lt;/label&gt;
  &lt;select id=&quot;voice_select&quot;&gt;&lt;/select&gt;
&lt;/div&gt;
&lt;label for=&quot;speech_text&quot;&gt;èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ: &lt;/label&gt;
&lt;input type=&quot;text&quot; id=&quot;speech_text&quot; name=&quot;speech_text&quot; value=&quot;ã“ã‚“ã«ã¡ã¯&quot; /&gt;
&lt;button type=&quot;button&quot; id=&quot;speech_button&quot;&gt;èª­ã¿ä¸Šã’&lt;/button&gt;
</code></pre>

        </details>

        <details open>
          <summary><h3>JavaScript</h3></summary>

<pre><code class="language-js">/**
 * Web Speech APIã®SpeechSynthesisã‚’ä½¿ã£ãŸéŸ³å£°èª­ã¿ä¸Šã’ã®åˆæœŸåŒ–
 * 
 * @param {HTMLButtonElement} buttonElement èª­ã¿ä¸Šã’ã‚’é–‹å§‹ã™ã‚‹ãƒœã‚¿ãƒ³è¦ç´ 
 * @param {HTMLInputElement} inputElement èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹è¦ç´ 
 * @param {HTMLSelectElement} voiceSelectElement éŸ³å£°ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹è¦ç´ 
 */
function setupSpeechSynthesis(buttonElement, inputElement, voiceSelectElement) {
  /** èª­ã¿ä¸Šã’è¨€èª */
  const LANG = 'ja-JP';

  /**
    * éŸ³å£°åˆæˆã®éŸ³å£°ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¦ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã«ã‚»ãƒƒãƒˆ
    */
  const populateVoiceList = () => {
    voiceSelectElement.innerHTML = '';
    // ãƒ–ãƒ©ã‚¦ã‚¶ã§åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã€ä½¿ç”¨ã™ã‚‹è¨€èªã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    window.speechSynthesis.getVoices()
      .filter((voice) => voice.lang === LANG)
      .forEach((voice, index) => {
        // å–å¾—ã—ãŸéŸ³å£°ãƒªã‚¹ãƒˆã‚’ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã®é¸æŠè‚¢ã«è¿½åŠ 
        const option = document.createElement('option');
        option.textContent = `${voice.name} (${voice.lang})`;
        option.value = index;
        voiceSelectElement.appendChild(option);
      });
  }
  populateVoiceList();
  speechSynthesis.onvoiceschanged = populateVoiceList;

  // ãƒœã‚¿ãƒ³ã«éŸ³å£°èª­ã¿ä¸Šã’ã®é–‹å§‹ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚»ãƒƒãƒˆ
  buttonElement.addEventListener('click', () => {
    // èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
    const speechText = inputElement.value;
    // SpeechSynthesisUtteranceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
    const speech = new SpeechSynthesisUtterance(speechText);
    // èª­ã¿ä¸Šã’è¨€èª (æ—¢å®šå€¤: HTMLã®langå±æ€§ã€ãªã‘ã‚Œã°UserAgentã®è¨€èª)
    speech.lang = LANG;
    // èª­ã¿ä¸Šã’é€Ÿåº¦ (0.1ã€œ10.0, æ—¢å®šå€¤: 1.0)
    speech.rate = 1.0;
    // èª­ã¿ä¸Šã’éŸ³é‡ (0.0ã€œ1.0, æ—¢å®šå€¤: 1.0)
    speech.volume = 1.0;
    // èª­ã¿ä¸Šã’éŸ³ç¨‹ (0.1ã€œ2.0, æ—¢å®šå€¤: 1.0)
    speech.pitch = 1.0;
    // èª­ã¿ä¸Šã’éŸ³å£° (SpeechSynthesisVoiceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)
    const selectedVoiceIndex = voiceSelectElement.value;
    const voices = speechSynthesis.getVoices()
      .filter((voice) => voice.lang === LANG);
    speech.voice = voices[selectedVoiceIndex];
    // èª­ã¿ä¸Šã’ã®é–‹å§‹
    speechSynthesis.speak(speech);
  });
}

const speechButtonElem = document.getElementById('speech_button');
const speechTextElem = document.getElementById('speech_text');
const voiceSelectElem = document.getElementById('voice_select');
setupSpeechSynthesis(speechButtonElem, speechTextElem, voiceSelectElem);
</code></pre>

        </details>

      </details>
    </section>

    <section>
      <details open>
        <summary><h2>éŸ³å£°èªè­˜ã®ãƒ‡ãƒ¢</h2></summary>

        <form>
          <fieldset>
            <legend>éŸ³å£°èªè­˜</legend>
            <button type="button" id="recognition_button">éŸ³å£°èªè­˜é–‹å§‹</button>
            <span id="listening"></span>
            <div id="recognized_text" style="margin-top: 8px;"></div>
          </fieldset>
        </form>

        <script>
          /**
           * Web Speech APIã®SpeechRecognitionã‚’ä½¿ã£ãŸéŸ³å£°èªè­˜ã®åˆæœŸåŒ–
           * 
           * @param {HTMLButtonElement} startButtonElem éŸ³å£°èªè­˜ã‚’é–‹å§‹ã™ã‚‹ãƒœã‚¿ãƒ³è¦ç´ 
           * @param {HTMLDivElement} recognizedTextElem èªè­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ 
           * @param {HTMLSpanElement} listeningElem éŸ³å£°èªè­˜ä¸­ã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ 
           */
          function setupSpeechRecognition(startButtonElem, recognizedTextElem, listeningElem) {
            // SpeechRecognitionãŒä½¿ãˆã‚‹ã‹ã©ã†ã‹ã®åˆ¤å®š
            if (window.SpeechRecognition === undefined && window.webkitSpeechRecognition === undefined) {
              // SpeechRecognitionã«å¯¾å¿œã—ã¦ã„ãªã„ãƒ–ãƒ©ã‚¦ã‚¶
              recognizedTextElem.textContent = 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚';
              return;
            }

            // SpeechRecognitionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            // èªè­˜è¨€èª (æ—¢å®šå€¤: HTMLã®langå±æ€§ã€ãªã‘ã‚Œã°UserAgentã®è¨€èª)
            recognition.lang = 'ja-JP';
            // æš«å®šçš„ãªçµæœã‚’è¿”ã™ã‹ã©ã†ã‹ (true: é€”ä¸­çµŒéã‚’è¿”ã™, false: æœ€çµ‚çµæœã®ã¿ã‚’è¿”ã™)
            recognition.interimResults = false;
            // æœ€å¤§ã®èªè­˜å€™è£œæ•° (æ—¢å®šå€¤: 1)
            recognition.maxAlternatives = 1;

            // éŸ³å£°èªè­˜ä¸­ã‹ã©ã†ã‹
            let loading = false;

            // éŸ³å£°èªè­˜ã®é–‹å§‹
            startButtonElem.addEventListener('click', () => {
              if (loading) {
                // é–‹å§‹ä¸­ã®å ´åˆã¯åœæ­¢
                startButtonElem.textContent = `éŸ³å£°èªè­˜é–‹å§‹`;
                listeningElem.textContent = ``;
                recognition.stop();
                loading = false;
                return;
              }
              // é–‹å§‹
              startButtonElem.textContent = `éŸ³å£°èªè­˜çµ‚äº†`;
              recognizedTextElem.textContent = ``;
              listeningElem.textContent = `ğŸ‘‚ï¸`;
              loading = true;
              recognition.start();
            });

            // éŸ³å£°èªè­˜ã®çµæœ
            recognition.addEventListener('result', (event) => {
              const transcript = event.results[0][0].transcript;
              recognizedTextElem.textContent = `èªè­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ: ${transcript}`;
            });

            // éŸ³å£°èªè­˜ã®çµ‚äº†
            recognition.addEventListener('speechend', () => {
              startButtonElem.textContent = `éŸ³å£°èªè­˜é–‹å§‹`;
              listeningElem.textContent = ``;
              recognition.stop();
              loading = false;
            });

            // éŸ³å£°èªè­˜ã®ã‚¨ãƒ©ãƒ¼
            recognition.addEventListener('error', (event) => {
              recognizedTextElem.textContent = `ã‚¨ãƒ©ãƒ¼: ${event.error}`;
            });
          }

          const recognitionButtonElem = document.getElementById('recognition_button');
          const recognizedTextElem = document.getElementById('recognized_text');
          const listeningElem = document.getElementById('listening');
          setupSpeechRecognition(recognitionButtonElem, recognizedTextElem, listeningElem);
        </script>

      </details>
    </section>

    <section>
      <details>
        <summary><h2>éŸ³å£°èªè­˜ã®ã‚³ãƒ¼ãƒ‰</h2></summary>

        <details open>
          <summary><h3>HTML</h3></summary>

<pre><code class="language-html">&lt;button type=&quot;button&quot; id=&quot;recognition_button&quot;&gt;éŸ³å£°èªè­˜é–‹å§‹&lt;/button&gt;
&lt;span id=&quot;listening&quot;&gt;&lt;/span&gt;
&lt;div id=&quot;recognized_text&quot;&gt;&lt;/div&gt;
</code></pre>

        </details>

        <details open>
          <summary><h3>JavaScript</h3></summary>

<pre><code class="language-js">/**
 * Web Speech APIã®SpeechRecognitionã‚’ä½¿ã£ãŸéŸ³å£°èªè­˜ã®åˆæœŸåŒ–
 * 
 * @param {HTMLButtonElement} startButtonElem éŸ³å£°èªè­˜ã‚’é–‹å§‹ã™ã‚‹ãƒœã‚¿ãƒ³è¦ç´ 
 * @param {HTMLDivElement} recognizedTextElem èªè­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ 
 * @param {HTMLSpanElement} listeningElem éŸ³å£°èªè­˜ä¸­ã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ 
 */
function setupSpeechRecognition(startButtonElem, recognizedTextElem, listeningElem) {
  // SpeechRecognitionãŒä½¿ãˆã‚‹ã‹ã©ã†ã‹ã®åˆ¤å®š
  if (window.SpeechRecognition === undefined && window.webkitSpeechRecognition === undefined) {
    // SpeechRecognitionã«å¯¾å¿œã—ã¦ã„ãªã„ãƒ–ãƒ©ã‚¦ã‚¶
    recognizedTextElem.textContent = 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚';
    return;
  }

  // SpeechRecognitionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  // èªè­˜è¨€èª (æ—¢å®šå€¤: HTMLã®langå±æ€§ã€ãªã‘ã‚Œã°UserAgentã®è¨€èª)
  recognition.lang = 'ja-JP';
  // æš«å®šçš„ãªçµæœã‚’è¿”ã™ã‹ã©ã†ã‹ (true: é€”ä¸­çµŒéã‚’è¿”ã™, false: æœ€çµ‚çµæœã®ã¿ã‚’è¿”ã™)
  recognition.interimResults = false;
  // æœ€å¤§ã®èªè­˜å€™è£œæ•° (æ—¢å®šå€¤: 1)
  recognition.maxAlternatives = 1;

  // éŸ³å£°èªè­˜ä¸­ã‹ã©ã†ã‹
  let loading = false;

  // éŸ³å£°èªè­˜ã®é–‹å§‹
  startButtonElem.addEventListener('click', () => {
    if (loading) {
      // é–‹å§‹ä¸­ã®å ´åˆã¯åœæ­¢
      startButtonElem.textContent = `éŸ³å£°èªè­˜é–‹å§‹`;
      listeningElem.textContent = ``;
      recognition.stop();
      loading = false;
      return;
    }
    // é–‹å§‹
    startButtonElem.textContent = `éŸ³å£°èªè­˜çµ‚äº†`;
    recognizedTextElem.textContent = ``;
    listeningElem.textContent = `ğŸ‘‚ï¸`;
    loading = true;
    recognition.start();
  });

  // éŸ³å£°èªè­˜ã®çµæœ
  recognition.addEventListener('result', (event) => {
    const transcript = event.results[0][0].transcript;
    recognizedTextElem.textContent = `èªè­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ: ${transcript}`;
  });

  // éŸ³å£°èªè­˜ã®çµ‚äº†
  recognition.addEventListener('speechend', () => {
    startButtonElem.textContent = `éŸ³å£°èªè­˜é–‹å§‹`;
    listeningElem.textContent = ``;
    recognition.stop();
    loading = false;
  });

  // éŸ³å£°èªè­˜ã®ã‚¨ãƒ©ãƒ¼
  recognition.addEventListener('error', (event) => {
    recognizedTextElem.textContent = `ã‚¨ãƒ©ãƒ¼: ${event.error}`;
  });
}

const recognitionButtonElem = document.getElementById('recognition_button');
const recognizedTextElem = document.getElementById('recognized_text');
const listeningElem = document.getElementById('listening');
setupSpeechRecognition(recognitionButtonElem, recognizedTextElem, listeningElem);
</code></pre>

        </details>

      </details>
    </section>

    <section>
      <details open>
        <summary><h2>å‚ç…§</h2></summary>

        <ul>
          <li>
            <a href="https://developer.mozilla.org/ja/docs/Web/API/Web_Speech_API" ref="nofollow noreferrer noopener" target="_blank">
              Web Speech API - Web API | MDN
            </a>
          </li>
          <li>
            <a href="https://developer.mozilla.org/ja/docs/Web/API/SpeechSynthesis" ref="nofollow noreferrer noopener" target="_blank">
              SpeechSynthesis - Web API | MDN
            </a>
          </li>
          <li>
            <a href="https://developer.mozilla.org/ja/docs/Web/API/SpeechRecognition" ref="nofollow noreferrer noopener" target="_blank">
              SpeechRecognition - Web API | MDN
            </a>
          </li>
          <li>
            <a href="https://caniuse.com/?search=SpeechSynthesis" ref="nofollow noreferrer noopener" target="_blank">
              SpeechSynthesis | Can I use...
            </a>
          </li>
          <li>
            <a href="https://caniuse.com/?search=SpeechSynthesisVoice" ref="nofollow noreferrer noopener" target="_blank">
              SpeechSynthesisVoice | Can I use...
            </a>
          </li>
          <li>
            <a href="https://caniuse.com/?search=SpeechRecognition" ref="nofollow noreferrer noopener" target="_blank">
              SpeechRecognition | Can I use...
            </a>
          </li>
          <li>
            <a href="https://caniuse.com/?search=SpeechGrammar" ref="nofollow noreferrer noopener" target="_blank">
              SpeechGrammar | Can I use...
            </a>
          </li>
        </ul>
      </details>
    </section>

  </div>
</body>
</html>
